---
title: "Prevalence of Diabetes in the United States"
author: Bobby Decker
subtitle: Visualizing the spread of diabetes in the United States from 2010-2018
---

# Introduction


Diabetes has been spreading rapidly throughout the United States through the last 20 years. Type 2 Diabetes is associated with obesity which stems from poor eating habits and lack of consistent physical activity. It has been studied that more than 100 million U.S. adults are living with diabetes or are considered prediabetic. 

As of 2015, 30.3 million Americans - 9.4 percent of the U.S. population - are diabetic. Diabetes is a serious disease that can be mitigated through increased physical activity to maintain safe and consistent blood sugar levels. 

# Materials and methods


For the purpose of this study, a few different visualizations of diabetes and levels of physical activity will be created through the R packages such as ggplot2. An animated map showing the change in spatial distribution of diabetes will be produced using the R package gganimate. 

First we must load the necessary R packages
```{r, message=FALSE, warning=FALSE, results=FALSE}
library(tidyverse)
library(dplyr)
library(ggplot2)
library(janitor)
library(gifski)
library(gganimate)
library(usmap)
library(ggthemes)
library(maps)
library(purrr)
library(patchwork)
```


Next we must read and transform the diabetes and physical inactivity data from the CDC's website https://gis.cdc.gov/grasp/diabetes/diabetesatlas-sdoh.html
```{r, message=FALSE, warning=FALSE} 
diabetes_2010<- read.csv("DiabetesAtlasData_2010.csv")
diabetes_2018 <- read.csv("DiabetesAtlasData_2018.csv")
inactivity_2010 <- read.csv("DiabetesAtlasData_activity_2010.csv")
inactivity_2018 <- read.csv("DiabetesAtlasData_activity_2018.csv")

diabetes_data<-cbind(diabetes_2010,diabetes_2018)%>%
  select(County_FIPS, Diagnosed.Diabetes.Percentage,Diagnosed.Diabetes.Percentage_2018)%>%
  rename(fips=County_FIPS)
inactivity_data<-cbind(inactivity_2010,inactivity_2018)
```


```{r, results='asis'}

```


# Results


First we are going to produce a map of the distribution of Diabetes in the United States in 2010
```{r, message=FALSE, warning=FALSE}
states <- plot_usmap("states", 
                     color = "red",
                     fill = alpha(0.01)) #this parameter is necessary to get counties to show on top of states
counties <- plot_usmap(data = diabetes_data, 
                       values = "Diagnosed.Diabetes.Percentage",
                       color = "black",
                       size = 0.1)

diabetes<-ggplot() +  
  geom_polygon(data=counties[[1]], 
               aes(x=x, 
                   y=y, 
                   group=group, 
                   fill = counties[[1]]$Diagnosed.Diabetes.Percentage), 
               color = "black",
               size = 0.1) +  
  geom_polygon(data=states[[1]], 
               aes(x=x, 
                   y=y, 
                   group=group), 
               color = "red", 
               fill = alpha(0.01)) + 
  coord_equal() +
  theme_map() +
  theme(legend.position="bottom") +
  scale_fill_gradient(low='white', high='grey20')+
  labs(
    title="US Diabetes Distribution 2010"
  )

diabetes
```


Now for comparison we are going to produce a similar map of the distribution of Diabetes in the United States in 2018
```{r, message=FALSE, warning=FALSE}
states <- plot_usmap("states", 
                     color = "red",
                     fill = alpha(0.01)) #this parameter is necessary to get counties to show on top of states
counties1 <- plot_usmap(data = diabetes_data, 
                       values = "Diagnosed.Diabetes.Percentage_2018",
                       color = "black",
                       size = 0.1)

diabetes1<-ggplot() +  
  geom_polygon(data=counties[[1]], 
               aes(x=x, 
                   y=y, 
                   group=group, 
                   fill = counties[[1]]$Diagnosed.Diabetes.Percentage_2018), 
               color = "black",
               size = 0.1) +  
  geom_polygon(data=states[[1]], 
               aes(x=x, 
                   y=y, 
                   group=group), 
               color = "red", 
               fill = alpha(0.01)) + 
  coord_equal() +
  theme_map() +
  theme(legend.position="bottom") +
  scale_fill_gradient(low='white', high='grey20')+
  labs(
    title="US Diabetes Distribution 2018"
  )

diabetes1
```

Now we are going use the patchwork package to compare these two maps side by side.
```{r}
diabetes+diabetes1
```

# Conclusions
test

Clear summary adequately describing the results and putting them in context. Discussion of further questions and ways to continue investigation.

# References

All sources are cited in a consistent manner
